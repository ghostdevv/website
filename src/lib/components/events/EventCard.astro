---
import { type Event, placeTagColours, typeTagColours } from './events';
import { getImage } from 'astro:assets';

interface Props {
	event: Event;
}

const { event } = Astro.props;

const img = await getImage({
	src: event.thumbnail,
	width: 800,
	format: 'webp',
});
---

<a href={event.url} target="_blank" class="event" title={event.name}>
	<div class="image" style={`background-image: url(${img.src});`}></div>

	<div class="details">
		<h3 class="title">{event.name}</h3>

		<div class="tags">
			<span
				class="tag"
				style={`--tag-colour: ${placeTagColours[event.place]};`}
			>
				{event.place.replaceAll('-', ' ')}
			</span>

			<span
				class="tag"
				style={`--tag-colour: ${typeTagColours[event.type]};`}
			>
				{event.type}
			</span>
		</div>
	</div>
</a>

<style lang="scss">
	@use 'include-media' as *;

	.event {
		display: flex;
		flex-direction: column;
		gap: 0px;

		min-width: 325px;
		width: 100%;

		color: var(--text);
		background-color: var(--background-secondary);
		border-radius: 12px;
		overflow: hidden;

		transition: box-shadow 0.2s ease-in-out;

		@include media('<400px') {
			min-width: 200px;
			flex-shrink: 0;
			width: 100%;
		}

		&:hover,
		&:active,
		&:focus {
			color: var(--text);
			text-decoration: none;
			background-color: var(--background-secondary);
			box-shadow:
				0 0 0 transparent,
				0 0 0 5px var(--primary);
		}

		.title {
			font-size: calc(1.275rem + 0.3vw);
			font-weight: 500;
		}

		.image {
			position: relative;
			width: 100%;
			height: auto;
			aspect-ratio: 2/1;
			background-position: 0% 50%;
			background-repeat: no-repeat;
			background-size: cover;

			transform: scale(1.04);
			border-radius: 12px 12px 0 0;
			box-shadow:
				-2px 1px 10px #000a inset,
				-2px 3px 20px #0006 inset,
				-7px 3px 3px #fff6 inset;
		}

		.details {
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: space-between;
			padding: 8px 18px;
			padding-top: 12px;

			.title {
				flex-grow: 1;
				text-overflow: ellipsis;
			}
		}
	}

	.tags {
		display: flex;
		flex-direction: row;
		align-items: center;
		gap: 8px;
	}

	.tag {
		background-color: rgba(var(--tag-colour), 0.2);
		color: rgba(var(--tag-colour));

		border-radius: 16px;

		padding: 4px 16px;
		font-size: 11px;
		font-weight: 800;

		height: fit-content;
		width: fit-content;

		text-transform: uppercase;
		white-space: nowrap;
	}
</style>
